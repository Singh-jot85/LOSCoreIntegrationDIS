{
    "xsd_name": "TPG_CustomerMaster",
    "xml_template": "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n    <SOAP-ENV:Header>\n        <wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">\n            <wsse:UsernameToken xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\">\n                <wsse:Username>{{XUserName}}</wsse:Username>\n                <wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\">{{XPassword}}</wsse:Password>\n                <wsu:Created xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\">{{current_timestamp}}</wsu:Created>\n            </wsse:UsernameToken>\n        </wsse:Security>\n    </SOAP-ENV:Header>\n    <SOAP-ENV:Body>\n        <CustRelAdd xmlns=\"http://jackhenry.com/jxchange/TPG/2008\">\n            <MsgRqHdr>\n                <jXchangeHdr>\n                    <JxVer />\n                    <AuditUsrId>{{XAuditUser}}</AuditUsrId>\n                    <AuditWsId>{{XAuditWorkStation}}</AuditWsId>\n                    <AuthenUsrId />\n                    <ConsumerName />\n                    <ConsumerProd />\n                    <Ver_1 />\n                    <jXLogTrackingId>{{guid}}</jXLogTrackingId>\n                    <Ver_2 />\n                    <InstRtId>{{XInstitutionRoutingID}}</InstRtId>\n                    <InstEnv>{{XEnvironment}}</InstEnv>\n                    <Ver_3 />\n                    <BusCorrelId>{{guid}}</BusCorrelId>\n                    <Ver_4 />\n                    <WorkflowCorrelId />\n                    <Ver_5 />\n                    <ValidConsmName>{{XValidConsumerName}}</ValidConsmName>\n                    <ValidConsmProd>{{XValidConsumerProduct}}</ValidConsmProd>\n                    <Ver_6 />\n                </jXchangeHdr>\n                <Ver_1 />\n                <Ver_2 />\n                <Ver_3 />\n            </MsgRqHdr>\n            {% if conditioningData and conditioningData.ErrOvrRds %}\n            <ErrOvrRdInfoArray>\n                <ErrOvrRd>\n                    {% for ErrOvrRd in conditioningData.ErrOvrRds %}\n                    <ErrCode>{{ErrOvrRd}}</ErrCode>\n                    <Ver_1 />\n                    {% endfor %}\n                </ErrOvrRd>\n            </ErrOvrRdInfoArray>\n            {% endif %}\n            <CustId>{{CustRelAdd.CustId}}</CustId>\n            <CustRelRec>\n                <Ver_1 />\n                <Ver_2 />\n                <Ver_3 />\n                <IdVerifyBy>{{CustRelAdd.CustRelRec.IdVerifyBy}}</IdVerifyBy>\n                <IdVerifyRsnCode>{{CustRelAdd.CustRelRec.IdVerifyRsnCode}}</IdVerifyRsnCode>\n                <VerifyDt>{{CustRelAdd.CustRelRec.VerifyDt}}</VerifyDt>\n                <Ver_4 />\n            </CustRelRec>\n            <Ver_1 />\n            <BenflOwnInfo>\n                <CustId>{{CustRelAdd.BenflOwnInfo.CustId}}</CustId>\n                <PersonName>\n                    <ComName>{{CustRelAdd.BenflOwnInfo.PersonName.ComName}}</ComName>\n                    <Ver_1 />\n                </PersonName>\n                <BenflOwnType>{{CustRelAdd.BenflOwnInfo.BenflOwnType}}</BenflOwnType>\n                <CntlIndivTitle>{{CustRelAdd.BenflOwnInfo.CntlIndivTitle}}</CntlIndivTitle>\n                <BenflOwnPct>{{CustRelAdd.BenflOwnInfo.BenflOwnPct}}</BenflOwnPct>\n                <Ver_1 />\n            </BenflOwnInfo>\n            <Ver_2 />\n            <Ver_3 />\n        </CustRelAdd>\n    </SOAP-ENV:Body>\n</SOAP-ENV:Envelope>",
    "xml_error_path": "s:Envelope/s:Body/s:Fault/detail/HdrFault/FaultRecInfoArray/FaultMsgRec/ErrDesc",
    "validation_spec": "{}",
    "xml_success_path": "s:Envelope/s:Body/CustRelAddResponse/RsStat",
    "request_body_spec": "def get_parent($pid; $flat_relations):\n    if $pid != \"\" and $pid != null\n        then $flat_relations[] | select(.id == $pid)\n    else null\n    end;\n\ndef get_parent_core_id($relation; $flat_relations):\n    if $relation.parent_id != null\n        then (\n            get_parent($relation.parent_id; $flat_relations) as $parent |\n            if $parent != null\n                then (\n                    if $parent.relation_type == \"owner\"\n                        then get_parent_core_id($parent; $flat_relations)\n                    elif $parent.relation_type == \"borrower\"\n                        then $parent.external_customer_id\n                    else \"\"\n                    end\n                )\n            else \"\"\n            end       \n        )\n    else \"\"\n    end;\n\n(\n    . as $root |\n    $root.loan_relations[0] | \n    {\n        CustRelAdd:{\n            CustId: (get_parent_core_id(. ; $root.flat_relations) // \"\"),\n            CustRelRec: { \n                IdVerifyBy: ($root.loan_officer_name // null),\n                IdVerifyRsnCode: \"1\",\n                VerifyDt: (.created | split(\"T\")[0] // \"\")\n            },\n            BenflOwnInfo:(            \n                { \n                    CustId: .external_customer_id,\n                    PersonName: { \n                        ComName: (.full_name // null)\n                    },\n                    BenflOwnType: (\n                        get_parent(.parent_id ; $root.flat_relations) as $parent |\n                        if $parent and $parent.relation_type == \"owner\"\n                            then \"OWN\"\n                        elif .is_ben_owner_by_control \n                            then (\n                                if .ownership_percentage \n                                    then \"CntlOwn\" \n                                else \"Cntl\" \n                                end\n                            ) \n                        else \"Own\"\n                        end\n                    ),\n                    CntlIndivTitle: (\n                        get_parent(.parent_id ; $root.flat_relations) as $parent |\n                        if $parent and $parent.relation_type == \"owner\"\n                            then \"\"\n                        elif .is_ben_owner_by_control \n                            then (.position // \"\")\n                        else \"\"\n                        end\n                    ),\n                    BenflOwnPct: (.effective_ownership_percentage // 0),\n                }\n            )\n        },\n        conditioningData: {\n            ErrOvrRds: [402066]\n        }\n    }\n)",
    "response_body_spec": "{ apiSuccess: .apiSuccess, errors: { errorNum: (if (.errors.errorNum != \"\" and .errors.errorNum != null) then .errors.errorNum else null end), errorMsg: ((if (.errors.errorNum != \"\" and .errors.errorNum != null) then .errors.errorMsg.Error else null end)) }, responses: (if .apiSuccess == true and .responses.Id then [{ status: .responses.Id }] else [] end) }",
    "request_body_spec_config": "{}",
    "response_body_spec_config": "{}"
}